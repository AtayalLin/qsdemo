<div class="bg-wave"></div>

@if (surveyData) {
<div class="result-page">
    <section class="survey-header">
        <h1 class="survey-title">{{ surveyData.title }}</h1>
        <p class="survey-intro">è«‹åˆ†äº«æ‚¨çš„çœ‹æ³•ï¼Œæˆ‘å€‘å°‡ä¾æ“šå›é¥‹æ‰“é€ æ¬¡ä¸–ä»£çš„éŠæˆ²é«”é©—ã€‚</p>
        <div class="survey-meta">
            <span>èª¿æŸ¥æœŸé–“ï¼š{{ surveyData.startDate }} ï½ {{ surveyData.endDate }}</span>
            <span>å•å· IDï¼š#{{ id }}</span>
        </div>
    </section>

    <form class="question-list" (submit)="onSubmit($event)">

        <div class="question-card user-info-card">
            <div class="question-head">
                <span class="question-type text">åŸºæœ¬è³‡æ–™</span>
                <h3>è¯çµ¡äººè³‡è¨Š</h3>
            </div>

            <div class="user-info-grid">
                <div class="input-group">
                    <label for="userName">å§“å</label>
                    <input type="text" id="userName" name="userName" [(ngModel)]="userInfo.name" placeholder="è«‹è¼¸å…¥å§“å"
                        class="custom-input" required>
                </div>
                <div class="input-group">
                    <label for="userPhone">é›»è©±</label>
                    <input type="tel" id="userPhone" name="userPhone" [(ngModel)]="userInfo.phone"
                        placeholder="0912-345-678" class="custom-input" required>
                </div>
                <div class="input-group">
                    <label for="userEmail">ä¿¡ç®±</label>
                    <input type="email" id="userEmail" name="userEmail" [(ngModel)]="userInfo.email"
                        placeholder="example@mail.com" class="custom-input" required>
                </div>
            </div>
        </div>

        @for (q of surveyData.questions; track q.id; let i = $index) {
        <div class="question-card">
            <div class="question-head">
                <span class="question-type" [class]="q.type">
                    {{ q.type === 'single' ? 'å–®é¸é¡Œ' : q.type === 'multiple' ? 'è¤‡é¸é¡Œ' : 'é–‹æ”¾é¡Œ' }}
                </span>
                <h3>Q{{ i + 1 }}ï¼š{{ q.title }}</h3>
            </div>

            <div class="list-layout">
                @switch (q.type) {
                @case ('single') {
                @for (opt of q.options; track opt) {
                <label class="custom-option">
                    <input type="radio" [name]="'q' + q.id" [value]="opt">
                    <div class="option-box">{{ opt }}</div>
                </label>
                }
                }
                @case ('multiple') {
                @for (opt of q.options; track opt) {
                <label class="custom-option">
                    <input type="checkbox" [name]="'q' + q.id" [value]="opt">
                    <div class="option-box">{{ opt }}</div>
                </label>
                }
                }
                @case ('text') {
                <textarea class="custom-textarea" [name]="'q' + q.id" placeholder="è«‹åœ¨æ­¤åˆ†äº«æ‚¨çš„å¯¶è²´æƒ³æ³•..."></textarea>
                }
                }
            </div>
        </div>
        }

        <div class="action-footer">
            <button type="button" class="btn-outline" (click)="goBack()">è¿”å›åˆ—è¡¨</button>
            <button type="submit" class="btn-gaming-submit" [disabled]="isSubmitting">
                {{ isSubmitting ? 'é€²å…¥é è¦½é é¢...' : 'é€å‡ºå•å·ä¸¦é è¦½' }}
            </button>
        </div>
    </form>
</div>
} @else {
<div class="result-page loading-box">
    <h1 class="survey-title">è¼‰å…¥å•å·ä¸­...</h1>
</div>
}

@if (showModal) {
<div class="modal-overlay">
    @switch (modalStep) {
        
        @case ('confirm') {
        <div class="gaming-modal">
            <div class="modal-icon">ğŸ“</div>
            <p class="modal-text">å³å°‡é€å‡ºå•å·ï¼Œ<br>ç¢ºå®šå…§å®¹å¡«å¯«ç„¡èª¤å—ï¼Ÿ</p>
            <div class="modal-actions">
                <button class="btn-modal-secondary" (click)="showModal = false">æª¢æŸ¥ä¸€ä¸‹</button>
                <button class="btn-modal-primary" (click)="finalSubmit()" [disabled]="isSubmitting">
                    {{ isSubmitting ? 'å‚³é€ä¸­...' : 'ç¢ºèªé€å‡º' }}
                </button>
            </div>
        </div>
        }

        @case ('thanks') {
        <div class="gaming-modal modal-animate-in">
            <div class="modal-icon">ğŸ‰</div>
            <p class="modal-text thanks-header">æ„Ÿè¬å¡«å¯«å•å· !!</p>
            <p class="modal-subtext">æˆ‘å€‘å·²æ”¶åˆ°æ‚¨çš„å¯¶è²´å»ºè­°ã€‚<br>æ­£åœ¨ç‚ºæ‚¨é–‹å•Ÿé è¦½é é¢...</p>
        </div>
        }
    }
</div>
}